!function(B){"use strict";var S=[],N=!1,P=!0;welaunch.field_objects=welaunch.field_objects||{},welaunch.field_objects.typography=welaunch.field_objects.typography||{},welaunch.field_objects.typography.init=function(e){e=B.welaunch.getSelector(e,"typography"),B(e).each(function(){var e=B(this),t=e;e.hasClass("welaunch-field-container")||(t=e.parents(".welaunch-field-container:first")),t.is(":hidden")||(void 0===welaunch.field_objects.pro&&(P=!1),e.each(function(){B(this).find(".welaunch-typography-container").each(function(){var e,t,a,r,s,o,i=B(this),p=i,d=B(this).find(".welaunch-typography-family"),n=d.data("value"),y=B(this).find(".welaunch-typography-family").parents(".welaunch-container-typography:first").data("id"),l=B("#"+y+" .welaunch-typography-google").val(),h=[],g=[],u=B("#"+y+" .welaunch-typography-font-family").data("user-fonts");if(i.hasClass("welaunch-field-container")||(p=i.parents(".welaunch-field-container:first")),!p.is(":hidden")&&p.hasClass("welaunch-field-init")){if(p.removeClass("welaunch-field-init"),void 0===n?d=B(this):""!==n&&B(d).val(n),u=u?1:0,l=l?1:0,void 0!==welaunch.customfonts&&h.push(welaunch.customfonts),void 0!==welaunch.typekitfonts&&h.push(welaunch.typekitfonts),void 0!==welaunch.stdfonts&&0==u&&h.push(welaunch.stdfonts),1==u){for(e in welaunch.optName.typography[y])if(welaunch.optName.typography[y].hasOwnProperty(e))for(a in t=welaunch.optName.typography[y].std_font)t.hasOwnProperty(a)&&g.push({id:a,text:a,"data-google":"false"});r={text:"Standard Fonts",children:g},h.push(r)}(1==l||!0===l&&void 0!==welaunch.googlefonts)&&h.push(welaunch.googlefonts),o=h,s=B(this).find(".welaunch-typography-family").data("value"),B(this).find(".welaunch-typography-family").addClass("ignore-change"),B(this).find(".welaunch-typography-family").select2({data:o}),B(this).find(".welaunch-typography-family").val(s).trigger("change"),B(this).find(".welaunch-typography-family").removeClass("ignore-change"),i.find(".welaunch-typography-family").hasClass("welaunch-typography-family")||i.find(".welaunch-typography-style").select2(),B(this).find(".welaunch-typography-align").select2(),B(this).find(".welaunch-typography-family-backup").select2(),B(this).find(".welaunch-typography-transform").select2(),B(this).find(".welaunch-typography-font-variant").select2(),B(this).find(".welaunch-typography-decoration").select2(),B(this).find(".welaunch-insights-data-we-collect-typography").on("click",function(e){e.preventDefault(),B(this).parent().find(".description").toggle()}),welaunch.field_objects.typography.select(d,!0,!1,null,!0),B(this).find(".welaunch-typography-family, .welaunch-typography-family-backup, .welaunch-typography-style, .welaunch-typography-subsets, .welaunch-typography-align").on("change",function(e){var t,a,r=B(this).attr("id"),s=B("#"+r);B(this).hasClass("welaunch-typography-family")?s.val()&&(a=(t=B(this).select2("data"))?t[0].text:null,s.data("value",a),S=t[0],N=!0,welaunch.field_objects.typography.select(s,!0,!1,a,!0)):(e=s.val(),s.data("value",e),(B(this).hasClass("welaunch-typography-align")||B(this).hasClass("welaunch-typography-subsets")||B(this).hasClass("welaunch-typography-family-backup")||B(this).hasClass("welaunch-typography-transform")||B(this).hasClass("welaunch-typography-font-variant")||B(this).hasClass("welaunch-typography-decoration"))&&(s.find('option[selected="selected"]').removeAttr("selected"),s.find('option[value="'+e+'"]').attr("selected","selected")),B(this).hasClass("welaunch-typography-subsets")&&s.siblings(".typography-subsets").val(e),welaunch.field_objects.typography.select(B(this),!0,!1,null,!1))}),B(this).find(".welaunch-typography-size, .welaunch-typography-height, .welaunch-typography-word, .welaunch-typography-letter").keyup(function(){welaunch.field_objects.typography.select(B(this).parents(".welaunch-container-typography:first"))}),P&&(welaunch.field_objects.pro.typography.fieldChange(B(this)),welaunch.field_objects.pro.typography.colorPicker(B(this))),B(this).find(".welaunch-typography-color").wpColorPicker({change:function(e,t){B(this).val(t.color.toString()),welaunch.field_objects.typography.select(B(this).parents(".welaunch-container-typography:first"))}}),B(this).find(".welaunch-typography-size").numeric({allowMinus:!1}),B(this).find(".welaunch-typography-height, .welaunch-typography-word, .welaunch-typography-letter").numeric({allowMinus:!0}),B(this).find(".welaunch-typography").on("select2:unselecting",function(){var e,t,a=B(this).data("select2").options;a.set("disabled",!0),setTimeout(function(){a.set("disabled",!1)},1),e=B(this).attr("id"),(t=B("#"+e)).data("value",""),B(this).hasClass("welaunch-typography-family")?(B(this).find(".welaunch-typography-family").addClass("ignore-change"),B(this).val(null).trigger("change"),B(this).find(".welaunch-typography-family").removeClass("ignore-change"),welaunch.field_objects.typography.select(t,!0,!1,null,!0)):((B(this).hasClass("welaunch-typography-align")||B(this).hasClass("welaunch-typography-subsets")||B(this).hasClass("welaunch-typography-family-backup")||B(this).hasClass("welaunch-typography-transform")||B(this).hasClass("welaunch-typography-font-variant")||B(this).hasClass("welaunch-typography-decoration"))&&B("#"+e+' option[selected="selected"]').removeAttr("selected"),B(this).hasClass("welaunch-typography-subsets")&&t.siblings(".typography-subsets").val(""),B(this).hasClass("welaunch-typography-family-backup")&&(B(this).find(".welaunch-typography-family-backup").addClass("ignore-change"),t.val(null).trigger("change"),B(this).find(".welaunch-typography-family-backup").removeClass("ignore-change")),welaunch.field_objects.typography.select(B(this),!0,!1,null,!1))}),welaunch.field_objects.typography.updates(B(this)),window.onbeforeunload=null,p.removeClass("welaunch-field-init")}})}))})},welaunch.field_objects.typography.updates=function(s){s.find(".update-google-fonts").bind("click",function(e){var a=B(this).data("action"),r=B(this).parent().parent(),t=r.attr("data-nonce");return r.find("p").text(welaunch_typography_ajax.update_google_fonts.updating),r.find("p").attr("aria-label",welaunch_typography_ajax.update_google_fonts.updating),r.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),B.ajax({type:"post",dataType:"json",url:welaunch_typography_ajax.ajaxurl,data:{action:"welaunch_update_google_fonts",nonce:t,data:a},error:function(e){var t;console.log(e),r.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),t=(t=e.error)&&': "'+t+'"',r.find("p").html(welaunch_typography_ajax.update_google_fonts.error.replace("%s",a).replace("|msg",t)),r.find("p").attr("aria-label",welaunch_typography_ajax.update_google_fonts.error),welaunch.field_objects.typography.updates(s)},success:function(e){var t;console.log(e),"success"===e.status?(r.find("p").html(welaunch_typography_ajax.update_google_fonts.success),r.find("p").attr("aria-label",welaunch_typography_ajax.update_google_fonts.success),r.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),B(".welaunch-update-google-fonts").not(".notice-success").remove()):(r.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),t=(t=e.error)&&': "'+t+'"',r.find("p").html(welaunch_typography_ajax.update_google_fonts.error.replace("%s",a).replace("|msg",t)),r.find("p").attr("aria-label",welaunch_typography_ajax.update_google_fonts.error),welaunch.field_objects.typography.updates(s))}}),e.preventDefault(),!1})},welaunch.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&(a+=1);return a},welaunch.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&!1!==e&&0!==e&&("true"===e||"1"===e||!0===e||1===e||void 0)},welaunch.field_objects.typography.contrastColour=function(e){var t="#444444";return""!==e&&(e=e.replace("#",""),t=128<=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3?"#444444":"#ffffff"),t},welaunch.field_objects.typography.select=function(e,t,a,r,s){var o,i,p,d,n,y,l,h,g,u,f,c,x,v,m,b,_,C,j=!1,w="",k='<option value=""></option>',z="",O={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},I=B(e).parents(".welaunch-container-typography:first").data("id");void 0===I&&(I=B(e).data("id")),o=B("#"+I),i=(i=B("#"+I+"-family").val())||null,r&&(i=r),d=o.find("select.welaunch-typography-family-backup").val(),n=o.find(".welaunch-typography-size").val(),y=o.find(".welaunch-typography-height").val(),l=o.find(".welaunch-typography-word").val(),h=o.find(".welaunch-typography-letter").val(),g=o.find("select.welaunch-typography-align").val(),u=o.find("select.welaunch-typography-transform").val(),f=o.find("select.welaunch-typography-font-variant").val(),c=o.find("select.welaunch-typography-decoration").val(),x=o.find("select.welaunch-typography-style").val(),v=o.find("select.welaunch-typography-subsets").val(),m=o.find(".welaunch-typography-color").val(),b=o.data("units"),!0===N?(p=welaunch.field_objects.typography.makeBool(S["data-google"]),o.find(".welaunch-typography-google-font").val(p)):p=welaunch.field_objects.typography.makeBool(o.find(".welaunch-typography-google-font").val()),s&&(o.hasClass("typography-initialized")||(x=o.find("select.welaunch-typography-style").data("value"),v=o.find("select.welaunch-typography-subsets").data("value"),""!==x&&(x=String(x)),v=String(v)),void 0===welaunch.fonts.google&&(p=!1),w=!0===p&&i in welaunch.fonts.google?welaunch.fonts.google[i]:void 0!==welaunch.fonts.typekit&&i in welaunch.fonts.typekit?(j=!0,welaunch.fonts.typekit[i]):O,B(e).hasClass("welaunch-typography-subsets")&&o.find("input.typography-subsets").val(v),B(e).hasClass("welaunch-typography-family")?(!0===p?(B.each(w.variants,function(e,t){t.id===x||1===welaunch.field_objects.typography.size(w.variants)?(z=' selected="selected"',x=t.id):z="",k+='<option value="'+t.id+'"'+z+">"+t.name.replace(/\+/g," ")+"</option>"}),a&&o.find(".welaunch-typography-style").select2("destroy"),o.find(".welaunch-typography-style").html(k).select2(),z="",k='<option value=""></option>',B.each(w.subsets,function(e,t){v===t.id||1===welaunch.field_objects.typography.size(w.subsets)?(z=' selected="selected"',v=t.id,o.find("input.typography-subsets").val(v)):z="",k+='<option value="'+t.id+'"'+z+">"+t.name.replace(/\+/g," ")+"</option>"}),a&&o.find(".welaunch-typography-subsets").select2("destroy"),o.find(".welaunch-typography-subsets").html(k).select2({width:"100%"}),o.find(".welaunch-typography-subsets").parent().fadeIn("fast"),o.find(".typography-family-backup").fadeIn("fast")):!0===j?(B.each(w.variants,function(e,t){x===t.id||1===welaunch.field_objects.typography.size(w.variants)?(z=' selected="selected"',x=t.id):z="",k+='<option value="'+t.id+'"'+z+">"+t.name.replace(/\+/g," ")+"</option>"}),o.find(".welaunch-typography-style").select2("destroy"),o.find(".welaunch-typography-style").html(k).select2(),o.find(".welaunch-typography-subsets").parent().fadeOut("fast"),o.find(".typography-family-backup").fadeOut("fast")):o.find(".welaunch-typography-style")&&(B.each(O,function(e,t){x===e||"normal"===e?(z=' selected="selected"',o.find(".typography-style select2-selection__rendered").text(t)):z="",k+='<option value="'+e+'"'+z+">"+t.replace("+"," ")+"</option>"}),a&&o.find(".welaunch-typography-style").select2("destroy"),o.find(".welaunch-typography-style").html(k).select2()),o.find(".welaunch-typography-font-family").val(i)):B(e).hasClass("welaunch-typography-family-backup")&&""!==d?o.find(".welaunch-typography-font-family-backup").val(d):(w=O)&&(B.each(w,function(e,t){x===e||"normal"===e?(z=' selected="selected"',o.find(".typography-style select2-selection__rendered").text(t)):z="",k+='<option value="'+e+'"'+z+">"+t.replace("+"," ")+"</option>"}),a&&o.find(".welaunch-typography-style").select2("destroy"),o.find(".welaunch-typography-style").html(k).select2(),o.find(".welaunch-typography-subsets").parent().fadeOut("fast"),o.find(".typography-family-backup").fadeOut("fast"))),s&&(o.find(".welaunch-typography-style").addClass("ignore-change"),0===o.find("select.welaunch-typography-style option[value='"+x+"']").length?(x="",o.find("select.welaunch-typography-style").val("").trigger("change")):"400"===x&&o.find("select.welaunch-typography-style").val(x).trigger("change"),o.find(".welaunch-typography-style").removeClass("ignore-change"),0===o.find("select.welaunch-typography-subsets option[value='"+v+"']").length&&(v="",o.find(".welaunch-typography-style").addClass("ignore-change"),o.find("select.welaunch-typography-subsets").val("").trigger("change"),o.find("input.typography-subsets").val(v),o.find(".welaunch-typography-style").removeClass("ignore-change"))),B("."+("style_link_"+I)).remove(),null!==i&&"inherit"!==i&&o.hasClass("typography-initialized")&&(_=i.replace(/\s+/g,"+"),!0===p?(C=_,x&&""!==x&&(C+=":"+x.replace(/\-/g," ")),v&&""!==v&&(C+="&subset="+v),!1===N&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[C]}}),o.find(".welaunch-typography-google").val(!0)):o.find(".welaunch-typography-google").val(!1)),x&&-1!==x.indexOf("italic")?(o.find(".typography-preview").css("font-style","italic"),o.find(".typography-font-style").val("italic"),x=x.replace("italic","")):(o.find(".typography-preview").css("font-style","normal"),o.find(".typography-font-style").val("")),o.find(".typography-font-weight").val(x),Boolean(o.find(".welaunch-typography-height").data("allow-empty"))||(y=y||n),""===n||void 0===n?o.find(".typography-font-size").val(""):o.find(".typography-font-size").val(n+b),""===y||void 0===y?o.find(".typography-line-height").val(""):o.find(".typography-line-height").val(y+b),""===l||void 0===l?o.find(".typography-word-spacing").val(""):o.find(".typography-word-spacing").val(l+b),""===h||void 0===h?o.find(".typography-letter-spacing").val(""):o.find(".typography-letter-spacing").val(h+b),P&&welaunch.field_objects.pro.typography.select(I),o.hasClass("typography-initialized")&&(0===o.find(".typography-preview").data("preview-size")&&o.find(".typography-preview").css("font-size",n+b),o.find(".typography-preview").css({"font-weight":x,"text-align":g,"font-family":i+", sans-serif"}),"none"===i&&""===i&&o.find(".typography-preview").css("font-family","inherit"),o.find(".typography-preview").css({"line-height":y+b,"word-spacing":l+b,"letter-spacing":h+b}),m&&o.find(".typography-preview").css("color",m),P&&welaunch.field_objects.typography.previewShadow(I),o.find(".typography-style select2-selection__rendered").text(o.find(".welaunch-typography-style option:selected").text()),o.find(".typography-script select2-selection__rendered").text(o.find(".welaunch-typography-subsets option:selected").text()),g&&o.find(".typography-preview").css("text-align",g),u&&o.find(".typography-preview").css("text-transform",u),f&&o.find(".typography-preview").css("font-variant",f),c&&o.find(".typography-preview").css("text-decoration",c),o.find(".typography-preview").slideDown()),o.hasClass("typography-initialized")||o.addClass("typography-initialized"),N=!1,t||welaunch_change(e)}}(jQuery);